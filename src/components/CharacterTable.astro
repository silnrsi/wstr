---
import { getCharacterName, USVNotFound } from '../plugins/coredata.mts';
import { parseUSV } from '../plugins/usv.mts';

const { startUsv, endUsv, caption } = Astro.props;

const start = parseUSV(startUsv);
const end = parseUSV(endUsv);

const rows = [];
for (let usv = start; usv <= end; usv++) {
  const characterName = await getCharacterName(usv);
  const character = characterName !== USVNotFound ? String.fromCodePoint(usv) : '';
  rows.push({ usv, character, characterName });
}
---
<div>
  <table>
    <thead>
      <tr>
        <th>USV</th>
        <th>Char</th>
        <th>Unicode Character Name</th>
      </tr>
    </thead>
    <tbody>
      {rows.map(row => (
        <tr>
          <td class="uni-char-metadata">U+{row.usv}</td>
          <td>{row.character}</td>
          <td class="uni-char-metadata">{row.characterName}</td>
        </tr>
      ))}
    </tbody>
  </table>
  {caption && <div class="table-caption">{caption}</div>}
</div>