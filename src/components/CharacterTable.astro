---
import { getCharacterName, ERROR_INVALID_USV } from '../utils/coredata_access';

const { startUsv, endUsv, caption } = Astro.props;

const start = parseInt(startUsv, 16);
const end = parseInt(endUsv, 16);

const rows = [];
for (let usvInt = start; usvInt <= end; usvInt++) {
  const usv = usvInt.toString(16).toUpperCase().padStart(4, '0');
  const characterName = await getCharacterName(usv);
  const character = characterName !== ERROR_INVALID_USV ? String.fromCodePoint(usvInt) : '';
  rows.push({ usv, character, characterName });
}
---

<style>
  .small-caps {
    font-variant: small-caps;
    font-size: 0.8em;
  }
  .large-char {
    font-size: 1.6em;
  }
  .caption {
    font-size: 0.8em;
    font-style: italic;
    text-align: left;
  }
</style>

<div>
  <table>
    <thead>
      <tr>
        <th>USV</th>
        <th>Char</th>
        <th>Unicode Character Name</th>
      </tr>
    </thead>
    <tbody>
      {rows.map(row => (
        <tr>
          <td class="small-caps">U+{row.usv}</td>
          <td class="large-char">{row.character}</td>
          <td class="small-caps">{row.characterName}</td>
        </tr>
      ))}
    </tbody>
  </table>
  {caption && <div class="caption">{caption}</div>}
</div>